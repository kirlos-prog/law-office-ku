/**
 * ÙƒÙˆØ¯ Google Apps Script Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù‚Ø¶Ø§ÙŠØ§ Ù…Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹
 * ====================================================
 * Ø§Ù„Ø®Ø·ÙˆØ§Øª:
 * 1. Ø§ÙØªØ­ ØµÙØ­Ø© Google Sheet Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯ ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠÙ‡Ø§.
 * 2. Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Extensions > Apps Script.
 * 3. Ø§Ù…Ø³Ø­ Ø£ÙŠ ÙƒÙˆØ¯ Ù…ÙˆØ¬ÙˆØ¯ØŒ ÙˆØ§Ù„ØµÙ‚ Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ù…ÙƒØ§Ù†Ù‡.
 * 4. Ø§Ø¶ØºØ· Save (ğŸ’¾).
 * 5. Ø§Ø¶ØºØ· Deploy > New deployment.
 * 6. Ø§Ø®ØªØ± Type: Web app.
 * 7. Ø§Ø¬Ø¹Ù„ "Who has access" = "Anyone" (Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹).
 * 8. Ø§Ù†Ø³Ø® Ø±Ø§Ø¨Ø· "Web app URL" ÙˆØ£Ø±Ø³Ù„Ù‡ Ù„ÙŠ.
 */

function doPost(e) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  
  // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†
  // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø´ÙŠØª ÙØ§Ø±ØºØ§Ù‹ØŒ Ø³Ù†Ø¶ÙŠÙ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
  if (sheet.getLastRow() === 0) {
    sheet.appendRow(["Ø§Ù„ØªØ§Ø±ÙŠØ®", "Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙƒÙ„", "Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„", "Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©", "Ø§Ù„Ù…Ø­Ø§Ù…ÙŠ Ø§Ù„Ù…Ø®ØªØ§Ø±", "ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù‚Ø¶ÙŠØ©"]);
  }
  
  // Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹
  var params = e.parameter;
  
  var date = new Date().toLocaleString(); // ØªØ§Ø±ÙŠØ® ÙˆØªÙˆÙ‚ÙŠØª Ø§Ù„Ø·Ù„Ø¨
  var name = params.clientName;
  var email = params.clientEmail;
  var service = params.serviceType;
  var lawyer = params.selectedLawyer;
  var details = params.caseDetails;
  
  // Ø¥Ø¶Ø§ÙØ© ØµÙ Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ø§Ù„Ø´ÙŠØª
  sheet.appendRow([date, name, email, service, lawyer, details]);
  
  // Ø§Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ù†Ø¬Ø§Ø­ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
  return ContentService.createTextOutput(JSON.stringify({"result":"success", "row": sheet.getLastRow()}))
    .setMimeType(ContentService.MimeType.JSON);
}

// Ø¯Ø§Ù„Ø© Ù„Ù„ØªØ¬Ø±Ø¨Ø© ÙÙ‚Ø·
function doGet(e) {
  return ContentService.createTextOutput("Service is working!");
}
